# DIS

Описание: TODO

## Подключение

TODO

Параметры UART:
- Скорость: 256000 бод
- Количество стоп-бит: 1
- Бит паритета: нет

## Формат пакета

| команда | аргумент | crc | данные (опционально) | сrc по данным (опционально)
| - | - | - | - | -

## Поддерживаемые запросы

Команды состоят из заголовка (4 байта в виде строки в кодировке ASCII) и аргумента (4 байта)

| Наименование | Заголовок | Аргумент | Ответ
| - | - | - | -
| Пинг | ping | **u32** | Код ошибки
| Питание коробки | cmd0 | **u32**: 0x0000_00FF - вкл, 0x0000_0000 - выкл | Код ошибки
| Ожидание импульса | cmd1 | **u32**: 0x0000_00FF - вкл, 0x0000_0000 - выкл | Код ошибки и далее результат обработки
| Задание времени задержки реакции на импульс в мс | cmd2 | **u32**: от 0 до 1000 | Код ошибки
| Задание длины оцифровываемого сигнала | cmd3 | **u32**:  $N_{sg}$ от 1024 до 32768 | Код ошибки
| Задание длины БПФ | cmd4 | **u32**: $N_{FFT}$ от 1024 до 32768 | Код ошибки
| Результат обработки | cmd5 | **u32**: 0x0000_0000 | Код ошибки или результат обработки
| Начать преобразование данных с АЦП | cmd7 | **u32**: 0x0000_0000 | Код ошибки или результат обработки
| Отправить N отсчетов сигнала | cmd8 | **u32**: $N_{sg}$ от 1024 до 32768 | Код ошибки или пакет отсчетов сигнала
| Отправить N отсчетов БПФ | cmd9 | **u32**: $N_{FFT}$ от 1024 до 32768 | Код ошибки или пакет отсчетов БПФ
### Примечание
Задержка также соблюдается при отправке команды начала преобразования данных с АЦП

## Поддерживаемые ответы
| Наименование | Заголовок | Аргумент | Данные
| - | - | - | -
| Результат обработки | rslt | **f32**: скорость, м/с | Отсутствуют
| Пакет сигнализации о приходе импульса | puls | **u32**: 0x0000_0000 | Отсутствуют
| Пакет сигнализации о начале конвертации | сonv | **u32**: 0x0000_0000 | Отсутствуют
| Пакет отсчетов сигнала | psig | **u32**: $N_{bytes}$ | **i16[ $N_{sg}$]**
| Пакет отсчетов БПФ | pfft | **u32**: $N_{bytes}$ | **f32[ $2\cdot N_{FFT}$ ]**: четные отсчеты - действительная часть, нечетные - мнимая
| Ошибка команды | erno | **u32**: 0x00000001 | Отсутствуют
| Ошибка аргумента | erno | **u32**: 0x00000002 | Отсутствуют
| Ошибка аргумента времени задержки | erno | **u32**: 0x00_00_01_02 | Отсутствуют
| Ошибка аргумента длины сигнала | erno | **u32**: 0x00_00_02_02 | Отсутствуют
| Ошибка аргумента длины БПФ | erno | **u32**: 0x00_00_03_02 | Отсутствуют

### Примечание
Пакет сигнализации о начале конвертации также приходит при отправке команды начала преобразования данных с АЦП